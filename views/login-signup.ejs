<% layout('layout') -%>

<div class="min-h-full flex flex-col justify-center py-12 sm:px-6 lg:px-8">
    <div class="sm:mx-auto sm:w-full sm:max-w-md">
        <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
            <%= title %>
        </h2>
    </div>

    <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
        <div class="bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10 border border-gray-200">
            <form class="space-y-6" action="<%= mode === 'login' ? '/auth/login' : '/auth/signup' %>" method="POST">

                <%# 리다이렉트 주소 (로그인 시) %>
                <% if (mode === 'login' && typeof redirect !== 'undefined' && redirect) { %>
                    <input type="hidden" name="redirect" value="<%= redirect %>">
                <% } %>

                <%# 회원가입 필드 %>
                <% if (mode === 'signup') { %>
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700"> 이름 </label>
                        <div class="mt-1"><input id="name" name="name" type="text" required class="input-field"></div>
                    </div>
                <% } %>

                <%# 공통 필드: ID, Password %>
                <div>
                    <label for="id" class="block text-sm font-medium text-gray-700"> 아이디 </label>
                    <div class="mt-1"><input id="id" name="id" type="text" required class="input-field"></div>
                </div>

                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700"> 비밀번호 </label>
                    <div class="mt-1"><input id="password" name="password" type="password" required class="input-field"></div>
                </div>

                <%# 회원가입 필드 %>
                <% if (mode === 'signup') { %>
                    <div>
                        <label for="passwordChk" class="block text-sm font-medium text-gray-700"> 비밀번호 확인 </label>
                        <div class="mt-1"><input id="passwordChk" name="passwordChk" type="password" required class="input-field"></div>
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700"> 이메일 주소 </label>
                        <div class="mt-1"><input id="email" name="email" type="email" required class="input-field"></div>
                    </div>
                    <div>
                        <label for="university" class="block text-sm font-medium text-gray-700"> 학교 (선택) </label>
                        <div class="mt-1"><input id="university" name="university" type="text" class="input-field"></div>
                    </div>
                    <div>
                        <label for="studentNum" class="block text-sm font-medium text-gray-700"> 학번 (선택) </label>
                        <div class="mt-1"><input id="studentNum" name="studentNum" type="text" class="input-field"></div>
                    </div>
                <% } %>

                <%# 로그인 시 '아이디 저장', '비밀번호 찾기' (옵션) %>
                <% if (mode === 'login') { %>
                    <div class="flex items-center justify-between">
                        <div class="text-sm">
                            <a href="/auth/signup" class="font-medium text-indigo-600 hover:text-indigo-500"> 아직 회원이 아니신가요? </a>
                        </div>
                    </div>
                <% } %>

                <div>
                    <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <%= title %>
                    </button>
                </div>
            </form>

            <%# 회원가입 시 로그인 페이지 링크 %>
            <% if (mode === 'signup') { %>
                <div class="mt-6 text-center text-sm">
                    <p class="text-gray-600">
                        이미 계정이 있으신가요?
                        <a href="/auth/login" class="font-medium text-indigo-600 hover:text-indigo-500"> 로그인하기 </a>
                    </p>
                </div>
            <% } %>

        </div>
    </div>
</div>

<%# 공통 Input 스타일 %>
<style>
    .input-field {
        appearance: none;
        display: block;
        width: 100%;
        padding: 0.75rem; /* px-3 py-2 */
        border: 1px solid #D1D5DB; /* border-gray-300 */
        border-radius: 0.375rem; /* rounded-md */
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
    }
    .input-field:focus {
        outline: none;
        --tw-ring-color: #6366F1; /* focus:ring-indigo-500 */
        --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
        --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);
        box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
        border-color: #6366F1; /* focus:border-indigo-500 */
    }
</style>
